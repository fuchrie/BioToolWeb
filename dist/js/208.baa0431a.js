"use strict";(self["webpackChunktry"]=self["webpackChunktry"]||[]).push([[208],{208:function(e,o,t){t.r(o),t.d(o,{default:function(){return F}});var a=t(6768);const l={class:"container"},r={class:"upload"},n={class:"check"};function s(e,o,t,s,c,d){const i=(0,a.g2)("bar"),u=(0,a.g2)("FileUpload"),p=(0,a.g2)("FlieCheck");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(i),(0,a.Lk)("div",l,[(0,a.Lk)("div",r,[o[0]||(o[0]=(0,a.Lk)("h3",null,"上传文件",-1)),(0,a.bF)(u)]),(0,a.Lk)("div",n,[o[1]||(o[1]=(0,a.Lk)("h3",null,"选择文件/文件夹",-1)),(0,a.bF)(p)])])],64)}t(4114);const c={class:"upload-container"};function d(e,o,t,l,r,n){const s=(0,a.g2)("upload-filled"),d=(0,a.g2)("el-icon"),i=(0,a.g2)("el-upload"),u=(0,a.g2)("el-button");return(0,a.uX)(),(0,a.CE)("div",c,[(0,a.bF)(i,{ref:"uploadRef",class:"upload-demo",drag:"",action:"http://202.195.187.9:8000/api/upload/",multiple:"",headers:l.headers,"on-preview":l.handlePreview,"on-remove":l.handleRemove,"before-upload":l.beforeUpload,"file-list":l.fileList,"auto-upload":!1},{default:(0,a.k6)((()=>[(0,a.bF)(d,{class:"icon"},{default:(0,a.k6)((()=>[(0,a.bF)(s)])),_:1}),o[0]||(o[0]=(0,a.Lk)("div",null,[(0,a.eW)(" 拖动或 "),(0,a.Lk)("em",null,"点击上传")],-1))])),_:1},8,["headers","on-preview","on-remove","before-upload","file-list"]),(0,a.bF)(u,{class:"submitbutton",type:"primary",onClick:l.submitUpload},{default:(0,a.k6)((()=>o[1]||(o[1]=[(0,a.eW)("上传文件")]))),_:1},8,["onClick"])])}var i=t(144),u=t(7477),p=t(1219),h={name:"fileupload",components:{UploadFilled:u.m8m},setup(){const e=(0,i.KR)([]),o=localStorage.getItem("token"),t=(0,i.KR)({Authorization:`Bearer ${o}`}),a=(e,o)=>{console.log(e,o)},l=e=>{console.log(e)},r=e=>{const o=e.size/1073741824<10;return!!o||(p.nk.error("大小不能超过10GB!"),!1)},n=(0,i.KR)(null),s=()=>{n.value&&n.value.submit()};return{fileList:e,handleRemove:a,handlePreview:l,beforeUpload:r,headers:t,submitUpload:s,uploadRef:n}}},k=t(1241);const f=(0,k.A)(h,[["render",d],["__scopeId","data-v-7da8ebc5"]]);var m=f,g=t(8735),v=t(9068),b=t(1387),y=t(3948),C={name:"user",components:{bar:v.A,FlieCheck:g.A,FileUpload:m},setup(){const e=(0,b.rd)(),o=localStorage.getItem("token");console.log("Token:",o),(0,a.KC)((()=>{(0,y.D)(o)&&(localStorage.removeItem("token"),console.log("Redirecting to login"),e.push("/login"))}))}};const A=(0,k.A)(C,[["render",s]]);var F=A},635:function(e,o,t){t(4114);var a=t(4373),l=t(3948),r=t(4436);const n=a.A.create({baseURL:"http://202.195.187.9:8000"});n.interceptors.request.use((e=>{const o=localStorage.getItem("token");if(o){if((0,l.D)(o))return localStorage.removeItem("token"),r.A.push("/login"),Promise.reject(new Error("Token expired"));e.headers.Authorization=`Bearer ${o}`}return e}),(e=>Promise.reject(e))),n.interceptors.response.use((e=>e),(e=>(e.response&&401===e.response.status&&(localStorage.removeItem("token"),r.A.push("/login")),Promise.reject(e)))),o.A=n},8735:function(e,o,t){t.d(o,{A:function(){return p}});var a=t(6768),l=t(4232);const r={class:"directory-tree"};function n(e,o,t,n,s,c){const d=(0,a.g2)("el-tree");return(0,a.uX)(),(0,a.CE)("div",r,[(0,a.bF)(d,{data:n.treeData,props:n.defaultProps,load:n.loadNode,lazy:"","node-key":"path",onNodeClick:n.handleNodeClick},{default:(0,a.k6)((({node:e,data:o})=>[(0,a.Lk)("span",null,[(0,a.Lk)("i",{class:(0,l.C4)("directory"===o.type?"el-icon-folder":"el-icon-document")},null,2),(0,a.eW)(" "+(0,l.v_)(e.label),1)])])),_:1},8,["data","props","load","onNodeClick"])])}var s=t(144),c=t(635),d={name:"filecheck",setup(){const e=(0,s.KR)([]),o=(0,s.KR)({label:"name",isLeaf:e=>"file"===e.type}),t=localStorage.getItem("token"),l={Authorization:`Bearer ${t}`};(0,a.sV)((async()=>{try{const o=await r();e.value=[{label:"Root",path:"",children:o.data.children||[]}]}catch(o){console.error("Error loading root node:",o)}}));const r=async()=>{0===node.level||node.data.path;const e=await c.A.get("http://202.195.187.9:8000/api/list-directory/",{headers:l});return e},n=async(e,o)=>{try{let t;const a=0===e.level?"":e.data.path;t=await c.A.get("http://202.195.187.9:8000/api/list-directory/",{headers:l,params:{path:a}}),o(t.data.children||[])}catch(t){console.error("Error loading node:",t),o([])}},d=e=>{console.log("Clicked node:",e)};return{treeData:e,defaultProps:o,loadNode:n,handleNodeClick:d}}},i=t(1241);const u=(0,i.A)(d,[["render",n],["__scopeId","data-v-132cd564"]]);var p=u}}]);
//# sourceMappingURL=208.baa0431a.js.map