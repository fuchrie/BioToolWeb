"use strict";(self["webpackChunktry"]=self["webpackChunktry"]||[]).push([[208],{208:function(e,o,t){t.r(o),t.d(o,{default:function(){return F}});var a=t(6768);const l={class:"container"},n={class:"upload"},r={class:"check"};function s(e,o,t,s,c,d){const i=(0,a.g2)("bar"),u=(0,a.g2)("FileUpload"),p=(0,a.g2)("FlieCheck");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(i),(0,a.Lk)("div",l,[(0,a.Lk)("div",n,[o[0]||(o[0]=(0,a.Lk)("h3",null,"上传文件",-1)),(0,a.bF)(u)]),(0,a.Lk)("div",r,[o[1]||(o[1]=(0,a.Lk)("h3",null,"选择文件/文件夹",-1)),(0,a.bF)(p)])])],64)}t(4114);const c={class:"upload-container"};function d(e,o,t,l,n,r){const s=(0,a.g2)("upload-filled"),d=(0,a.g2)("el-icon"),i=(0,a.g2)("el-upload"),u=(0,a.g2)("el-button");return(0,a.uX)(),(0,a.CE)("div",c,[(0,a.bF)(i,{ref:"uploadRef",class:"upload-demo",drag:"",action:"http://202.195.187.9:8000/api/upload/",multiple:"",headers:l.headers,"on-preview":l.handlePreview,"on-remove":l.handleRemove,"before-upload":l.beforeUpload,"file-list":l.fileList,"auto-upload":!1},{default:(0,a.k6)((()=>[(0,a.bF)(d,{class:"icon"},{default:(0,a.k6)((()=>[(0,a.bF)(s)])),_:1}),o[0]||(o[0]=(0,a.Lk)("div",null,[(0,a.eW)(" 拖动或 "),(0,a.Lk)("em",null,"点击上传")],-1))])),_:1},8,["headers","on-preview","on-remove","before-upload","file-list"]),(0,a.bF)(u,{class:"submitbutton",type:"primary",onClick:l.submitUpload},{default:(0,a.k6)((()=>o[1]||(o[1]=[(0,a.eW)("上传文件")]))),_:1},8,["onClick"])])}var i=t(144),u=t(7477),p=t(1219),h={name:"fileupload",components:{UploadFilled:u.m8m},setup(){const e=(0,i.KR)([]),o=localStorage.getItem("token"),t=(0,i.KR)({Authorization:`Bearer ${o}`}),a=(e,o)=>{console.log(e,o)},l=e=>{console.log(e)},n=e=>{const o=e.size/1073741824<10;return!!o||(p.nk.error("大小不能超过10GB!"),!1)},r=(0,i.KR)(null),s=()=>{r.value&&r.value.submit()};return{fileList:e,handleRemove:a,handlePreview:l,beforeUpload:n,headers:t,submitUpload:s,uploadRef:r}}},g=t(1241);const k=(0,g.A)(h,[["render",d],["__scopeId","data-v-7da8ebc5"]]);var f=k,m=t(3030),v=t(7946),C=t(1387),b=t(3948),y={name:"user",components:{bar:v.A,FlieCheck:m.A,FileUpload:f},setup(){const e=(0,C.rd)(),o=localStorage.getItem("token");console.log("Token:",o),(0,a.KC)((()=>{(0,b.D)(o)&&(localStorage.removeItem("token"),console.log("Redirecting to login"),e.push("/login"))}))}};const A=(0,g.A)(y,[["render",s]]);var F=A},635:function(e,o,t){t(4114);var a=t(4373),l=t(3948),n=t(6874);const r=a.A.create({baseURL:"http://202.195.187.9:8000"});r.interceptors.request.use((e=>{const o=localStorage.getItem("token");if(o){if((0,l.D)(o))return localStorage.removeItem("token"),n.A.push("/login"),Promise.reject(new Error("Token expired"));e.headers.Authorization=`Bearer ${o}`}return e}),(e=>Promise.reject(e))),r.interceptors.response.use((e=>e),(e=>(e.response&&401===e.response.status&&(localStorage.removeItem("token"),n.A.push("/login")),Promise.reject(e)))),o.A=r},3030:function(e,o,t){t.d(o,{A:function(){return p}});var a=t(6768),l=t(4232);const n={class:"directory-tree"};function r(e,o,t,r,s,c){const d=(0,a.g2)("el-pagination"),i=(0,a.g2)("el-tree");return(0,a.uX)(),(0,a.CE)("div",n,[(0,a.bF)(i,{ref:"tree",data:r.treeData,props:r.defaultProps,load:r.loadNode,lazy:"","node-key":"path","show-checkbox":"",onCheckChange:r.handleCheckChange,onNodeClick:r.handleNodeClick},{default:(0,a.k6)((({node:o,data:t})=>[(0,a.Lk)("span",null,[(0,a.Lk)("i",{class:(0,l.C4)("directory"===t.type?"el-icon-folder":"el-icon-document")},null,2),(0,a.eW)(" "+(0,l.v_)(o.label),1)]),"directory"===t.type&&t.total>10?((0,a.uX)(),(0,a.Wv)(d,{key:0,small:"",layout:"prev, pager, next",total:t.total,"page-size":10,"current-page":t.page,onCurrentChange:t=>e.handlePageChange(o,t)},null,8,["total","current-page","onCurrentChange"])):(0,a.Q3)("",!0)])),_:1},8,["data","props","load","onCheckChange","onNodeClick"])])}t(8111),t(2489),t(1701);var s=t(144),c=t(635),d={name:"filecheck",emits:["selected-files"],setup(e,{emit:o}){const t=(0,s.KR)([]),l=(0,s.KR)(null),n=(0,s.KR)({label:"name",isLeaf:e=>"file"===e.type}),r=localStorage.getItem("token"),d={Authorization:`Bearer ${r}`};(0,a.sV)((async()=>{try{const e=await i();t.value=[{label:"Root",path:"",children:e.data.children||[]}]}catch(e){console.error("Error loading root node:",e)}}));const i=async()=>{0===node.level||node.data.path;const e=await c.A.get("http://202.195.187.9:8000/api/list-directory/",{headers:d});return e},u=async(e,o)=>{try{let t;const a=0===e.level?"":e.data.path;t=await c.A.get("http://202.195.187.9:8000/api/list-directory/",{headers:d,params:{path:a}}),o(t.data.children||[])}catch(t){console.error("Error loading node:",t),o([])}},p=e=>{console.log("Clicked node:",e)},h=()=>{if(l.value){const e=l.value.getCheckedNodes(),t=e.filter((e=>"file"===e.type)).map((e=>e.name));o("selected-files",t)}};return{treeData:t,defaultProps:n,loadNode:u,handleNodeClick:p,handleCheckChange:h,tree:l}}},i=t(1241);const u=(0,i.A)(d,[["render",r],["__scopeId","data-v-775d4080"]]);var p=u}}]);
//# sourceMappingURL=208.7bef16c3.js.map